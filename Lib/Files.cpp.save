#include "TXLib.h"

void saveToFile()
{
    txRectangle(2,2, 200, 60);
        txDrawText(2,2,200,60, "Открыть", 5);
        if (txMouseButtons() == 1 &&
                txMouseX() > 2 &&  txMouseY() > 2 &&
                txMouseX() < 200 &&  txMouseY() < 60)
        {
            OPENFILENAME ofn;			// структура стандартного диалогового окна
            char szFile[260] = {0};			// буфер для имени файла

            // Инициализация OPENFILENAME
            ZeroMemory(&ofn, sizeof(ofn));
            ofn.lStructSize = sizeof(ofn);
            ofn.hwndOwner = txWindow();
            ofn.lpstrFile = szFile;
            ofn.nMaxFile = sizeof(szFile);
            ofn.lpstrFilter = "Text\0*.TXT\0";
            ofn.nFilterIndex = 1;
            ofn.lpstrFileTitle = NULL;
            ofn.nMaxFileTitle = 0;
            ofn.lpstrInitialDir = NULL;
            ofn.Flags = OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST;


            // Покажем диалоговое окно Открыть (Open).

            if (GetSaveFileName(&ofn))
            {
                string fileName = ofn.lpstrFile;

                ofstream file2(fileName);

                for (int i = 0; i < n_pics; i++)
                {

                    file2 << pic[i].x << endl;

                    file2 << pic[i].y << endl;

                    file2 << pic[i].address << endl;
                }

                file2.close();

            }    //return 0;
        }


    }


        txSleep(15);
        txEnd();
}
